From: Kevin Roy <kiniou@gmail.com>
Date: Tue, 28 Sep 2010 15:00:21 +0200
Subject: [PATCH] install_in_usr_lib

 * Arch-specific files go to /usr/lib rather than /usr/share.
 * Make blender look for systemdir into /usr/lib instead of /usr/share
 * Remove blender_version from system directory result
---
 intern/ghost/intern/GHOST_SystemX11.cpp   |    2 +-
 source/blender/blenlib/BLI_path_util.h    |    2 +-
 source/blender/blenlib/intern/path_util.c |    2 +-
 source/creator/CMakeLists.txt             |    2 +-
 4 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/intern/ghost/intern/GHOST_SystemX11.cpp b/intern/ghost/intern/GHOST_SystemX11.cpp
index 5a6f988..d25bff3 100644
--- a/intern/ghost/intern/GHOST_SystemX11.cpp
+++ b/intern/ghost/intern/GHOST_SystemX11.cpp
@@ -1478,7 +1478,7 @@ void GHOST_SystemX11::putClipboard(GHOST_TInt8 *buffer, bool selection) const
 
 const GHOST_TUns8* GHOST_SystemX11::getSystemDir() const
 {
-	return (GHOST_TUns8*) PREFIX "/share";
+	return (GHOST_TUns8*) PREFIX "/lib";
 }
 
 const GHOST_TUns8* GHOST_SystemX11::getUserDir() const
diff --git a/source/blender/blenlib/BLI_path_util.h b/source/blender/blenlib/BLI_path_util.h
index 08ec4f8..0ebd3ee 100644
--- a/source/blender/blenlib/BLI_path_util.h
+++ b/source/blender/blenlib/BLI_path_util.h
@@ -85,7 +85,7 @@ char *BLI_get_user_folder_notest(int folder_id, char *subfolder);
 #define BLENDER_SYSTEM_FORMAT			"%s/Blender/%s"
 #else
 #define BLENDER_USER_FORMAT			"%s/.blender/%s"
-#define BLENDER_SYSTEM_FORMAT			"%s/blender/%s"
+#define BLENDER_SYSTEM_FORMAT			"%s/blender"
 #endif
 
 #ifdef WIN32
diff --git a/source/blender/blenlib/intern/path_util.c b/source/blender/blenlib/intern/path_util.c
index 15b14d6..df5109e 100644
--- a/source/blender/blenlib/intern/path_util.c
+++ b/source/blender/blenlib/intern/path_util.c
@@ -938,7 +938,7 @@ static int get_path_system(char *targetpath, char *folder_name, char *subfolder_
 
 	system_base_path = (const char *)GHOST_getSystemDir();
 	if (system_base_path) {
-		BLI_snprintf(system_path, FILE_MAX, BLENDER_SYSTEM_FORMAT, system_base_path, blender_version_decimal());
+		BLI_snprintf(system_path, FILE_MAX, BLENDER_SYSTEM_FORMAT, system_base_path);
 	}
 	
 	if(!system_path[0])
diff --git a/source/creator/CMakeLists.txt b/source/creator/CMakeLists.txt
index 31e7a9f..a58e9ac 100644
--- a/source/creator/CMakeLists.txt
+++ b/source/creator/CMakeLists.txt
@@ -229,7 +229,7 @@ IF(WITH_INSTALL)
 		)
 		INSTALL(
 			DIRECTORY ${CMAKE_SOURCE_DIR}/release/scripts/
-			DESTINATION ${CMAKE_INSTALL_PREFIX}/share/blender/${BLENDER_VERSION}/scripts
+			DESTINATION ${CMAKE_INSTALL_PREFIX}/lib/blender/scripts
 			PATTERN ".svn" EXCLUDE
 			PATTERN "*.pyc" EXCLUDE
 		)
-- 
